# atv-0404

-- 01.
USE ENTRETERIMENTO;

-- 02.
ALTER TABLE ENTRETERIMENTO
ADD NACIONALIDADE VARCHAR(50);

-- 03.
UPDATE ENTRETERIMENTO 
SET NACIONALIDADE = 
    CASE 
        WHEN ID IN (1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14) THEN 'EUA'
        WHEN ID = 2 THEN 'Reino Unido' -- Black Mirror
        WHEN ID IN (15, 17, 20, 23, 25, 26, 28, 30) THEN 'Brasil'
        WHEN ID = 16 THEN 'Irlanda' -- Vikings
        WHEN ID = 18 THEN 'EUA' -- The Dark Knight
        WHEN ID = 19 THEN 'EUA' -- Grey’s Anatomy
        WHEN ID = 21 THEN 'EUA' -- The Shawshank Redemption
        WHEN ID = 22 THEN 'EUA' -- Gladiador
        WHEN ID = 24 THEN 'Nova Zelândia' -- O Senhor dos Anéis: A Sociedade do Anel
        WHEN ID = 27 THEN 'Espanha' -- La Casa de Papel
        WHEN ID = 29 THEN 'Espanha' -- Money Heist
        WHEN ID = 31 THEN 'EUA' -- The Witcher
        WHEN ID = 32 THEN 'EUA' -- The Matrix
        WHEN ID = 33 THEN 'EUA' -- Money Heist
        WHEN ID = 34 THEN 'EUA' -- Forrest Gump
        WHEN ID = 35 THEN 'Irlanda' -- Vikings
        WHEN ID = 36 THEN 'EUA' -- The Dark Knight
    END
WHERE 
    ID BETWEEN 1 AND 36;

-- 04.
ALTER TABLE ENTRETERIMENTO
ADD RANKING INT;

-- 05.
ALTER TABLE ENTRETERIMENTO
ADD RANKING_TIPO VARCHAR(50);

-- 06.
ALTER TABLE ENTRETERIMENTO
ADD RANKING_NOME VARCHAR(50);

-- 07.
INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING, RANKING_TIPO, RANKING_NOME) 
VALUES ('The Platform', 'FILME', 'Galder Gaztelu-Urrutia', 'Ivan Massagué', 'Zorion Eguileor', 2019, 94, '18+', 'Ficção Científica', 'Espanha', NULL, NULL, 'NETFLIX');

INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING, RANKING_TIPO, RANKING_NOME) 
VALUES ('Cidade de Deus', 'FILME', 'Fernando Meirelles e Kátia Lund', 'Alexandre Rodrigues', 'Alice Braga', 2002, 130, '18+', 'Crime/Drama', 'Brasil', NULL, NULL, 'NETFLIX');

-- 08.
INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING, RANKING_TIPO, RANKING_NOME) 
VALUES ('One Night in Miami', 'FILME', 'Regina King', 'Kingsley Ben-Adir', 'Eli Goree', 2020, 114, '14+', 'Drama', 'EUA', NULL, NULL, 'AMAZON PRIME');

INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING, RANKING_TIPO, RANKING_NOME) 
VALUES ('The Tomorrow War', 'FILME', 'Chris McKay', 'Chris Pratt', 'Yvonne Strahovski', 2021, 140, '14+', 'Ação/Ficção Científica', 'EUA', NULL, NULL, 'AMAZON PRIME');

-- 09.
INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING, RANKING_TIPO, RANKING_NOME) 
VALUES ('Bacurau', 'FILME', 'Kleber Mendonça Filho e Juliano Dornelles', 'Barbara Colen', 'Sônia Braga', 2019, 131, '16+', 'Ação/Drama', 'Brasil', NULL, NULL, 'MEU RANKING');

INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING, RANKING_TIPO, RANKING_NOME) 
VALUES ('Bingo: O Rei das Manhãs', 'FILME', 'Daniel Rezende', 'Vladimir Brichta', 'Leandra Leal', 2017, 113, '16+', 'Comédia/Drama', 'Brasil', NULL, NULL, 'MEU RANKING');

-- 10.
UPDATE ENTRETERIMENTO SET RANKING_NOME = 'NETFLIX' WHERE RANKING_NOME IS NULL;

-- 11.
UPDATE ENTRETERIMENTO SET RANKING_TIPO = 'Nacional' WHERE RANKING_NOME = 'NETFLIX';
UPDATE ENTRETERIMENTO SET RANKING_TIPO = 'Nacional' WHERE RANKING_NOME = 'AMAZON PRIME';
UPDATE ENTRETERIMENTO SET RANKING_TIPO = 'Nacional' WHERE RANKING_NOME = 'MEU RANKING';

-- 12.
SET @counter = 0; -- Inicializa a variável de contagem

UPDATE ENTRETERIMENTO
SET RANKING = (@counter := @counter + 1) -- Incrementa o contador e atribui o valor ao campo RANKING
ORDER BY RAND(); -- Ordena aleatoriamente os registros

-- Atualiza o campo RANKING_TIPO para indicar que é um ranking aleatório
UPDATE ENTRETERIMENTO
SET RANKING_TIPO = 'Aleatório';
